<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智慧园区3D监控系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0033 25%, #000d1a 50%, #001a0d 75%, #0a0a0a 100%);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            padding-top: 70px;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* ========== 顶部标题栏 ========== */
        .top-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: linear-gradient(135deg, rgba(10, 20, 40, 0.95), rgba(20, 10, 50, 0.95));
            backdrop-filter: blur(20px);
            border-bottom: 2px solid rgba(0, 255, 255, 0.3);
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 255, 255, 0.1);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
            height: 100%;
        }

        .system-logo {
            font-size: 28px;
            margin-right: 15px;
            animation: logoGlow 3s ease-in-out infinite;
        }

        @keyframes logoGlow {
            0%, 100% { text-shadow: 0 0 10px #00ffff; }
            50% { text-shadow: 0 0 20px #00ffff, 0 0 30px #0080ff; }
        }

        .system-title {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(45deg, #00ffff, #0080ff, #8000ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-right: 20px;
        }

        .system-subtitle {
            font-size: 14px;
            color: #88aaff;
            font-weight: 300;
            letter-spacing: 2px;
        }

        .system-status {
            display: flex;
            align-items: center;
            background: rgba(0, 255, 255, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid rgba(0, 255, 255, 0.3);
            font-size: 13px;
            color: #00ffff;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
            animation: statusPulse 2s infinite;
        }

        .status-indicator.running {
            background: #00ff88;
            box-shadow: 0 0 10px #00ff88;
        }

        @keyframes statusPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        .main-container {
            display: grid;
            grid-template-columns: 320px 1fr 350px;
            height: calc(100vh - 70px);
            gap: 15px;
            padding: 15px;
        }

        /* ========== 左侧视频上传区域 ========== */
        .left-panel {
            background: rgba(15, 15, 30, 0.9);
            border-radius: 20px;
            padding: 20px;
            border: 2px solid rgba(100, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 40px rgba(0, 100, 255, 0.15);
            position: relative;
            overflow: hidden;
        }

        .left-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(100, 255, 255, 0.1), transparent);
            animation: scanLine 3s infinite;
        }

        @keyframes scanLine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .panel-title {
            font-size: 18px;
            font-weight: bold;
            background: linear-gradient(45deg, #00f5ff, #0080ff, #8000ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            text-align: center;
        }

        .upload-zone {
            border: 3px dashed rgba(100, 255, 255, 0.4);
            border-radius: 15px;
            padding: 30px 20px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            background: rgba(0, 50, 100, 0.1);
        }

        .upload-zone:hover {
            border-color: #00f5ff;
            background: rgba(0, 245, 255, 0.1);
            transform: scale(1.02);
        }

        .upload-zone.dragover {
            border-color: #8000ff;
            background: rgba(128, 0, 255, 0.2);
            transform: scale(1.05);
        }

        .upload-icon {
            font-size: 48px;
            color: #00f5ff;
            margin-bottom: 15px;
            animation: float 2s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .video-preview {
            width: 100%;
            border-radius: 10px;
            margin-bottom: 15px;
            display: none;
            box-shadow: 0 10px 30px rgba(0, 245, 255, 0.3);
        }

        .video-info {
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(100, 255, 255, 0.3);
            display: none;
        }

        .select-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(45deg, #00f5ff, #0080ff);
            border: none;
            border-radius: 25px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
            display: none;
        }

        .select-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0, 245, 255, 0.5);
        }

        /* ========== 中间分析区域 ========== */
        .center-panel {
            background: rgba(10, 10, 30, 0.95);
            border-radius: 25px;
            padding: 30px;
            border: 2px solid rgba(255, 100, 255, 0.2);
            backdrop-filter: blur(25px);
            position: relative;
            overflow-y: auto;
            overflow-x: hidden;
        }

        /* 自定义滚动条样式 */
        .center-panel::-webkit-scrollbar {
            width: 8px;
        }

        .center-panel::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }

        .center-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #ff00ff, #00ffff);
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .center-panel::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #ff0080, #0080ff);
            box-shadow: 0 0 10px rgba(255, 0, 255, 0.5);
        }

        .center-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 0, 100, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 255, 100, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .search-container {
            position: relative;
            margin-bottom: 30px;
            z-index: 10;
        }

        .search-box {
            position: relative;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 50px;
            padding: 5px;
            border: 2px solid rgba(255, 100, 255, 0.4);
            box-shadow: 0 10px 40px rgba(255, 0, 255, 0.2);
        }

        .search-input {
            width: calc(100% - 120px);
            background: none;
            border: none;
            padding: 20px 30px;
            color: #fff;
            font-size: 16px;
            outline: none;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .analyze-btn {
            position: absolute;
            right: 5px;
            top: 5px;
            padding: 15px 30px;
            background: linear-gradient(45deg, #ff0080, #8000ff);
            border: none;
            border-radius: 45px;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .analyze-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 25px rgba(255, 0, 128, 0.6);
        }

        .analysis-display {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 20px;
            padding: 25px;
            min-height: 400px;
            border: 1px solid rgba(255, 100, 255, 0.3);
            position: relative;
            display: none;
        }

        .analysis-status {
            text-align: center;
            margin-bottom: 20px;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .analysis-status.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .status-text {
            font-size: 20px;
            color: #00f5ff;
            margin-bottom: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .frame-carousel {
            position: relative;
            width: 100%;
            height: 300px;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
            background: #000;
        }

        .frame-image {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            transition: all 0.8s ease;
            transform: scale(1);
        }

        .frame-image.active {
            opacity: 1;
            transform: scale(1.05);
        }

        .frame-image.analyzing {
            transform: scale(1.15);
            filter: brightness(1.3) contrast(1.2) saturate(1.4);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.6);
        }

        .analysis-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                rgba(255, 0, 255, 0.1), 
                rgba(0, 255, 255, 0.1), 
                rgba(255, 255, 0, 0.1));
            opacity: 0;
            animation: analyzeFlash 1.5s infinite;
        }

        @keyframes analyzeFlash {
            0%, 100% { opacity: 0; }
            50% { opacity: 0.7; }
        }

        .extraction-info {
            background: rgba(0, 0, 0, 0.9);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #00f5ff;
            margin-top: 15px;
        }

        .result-display {
            background: linear-gradient(135deg, rgba(0, 50, 100, 0.3), rgba(50, 0, 100, 0.3));
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border: 2px solid rgba(100, 255, 255, 0.4);
            display: none;
        }

        /* ========== 右侧效果和指标区域 ========== */
        .right-panel {
            background: rgba(15, 15, 35, 0.95);
            border-radius: 25px;
            padding: 25px;
            border: 2px solid rgba(0, 255, 255, 0.3);
            backdrop-filter: blur(25px);
            position: relative;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .right-panel::-webkit-scrollbar {
            width: 6px;
        }

        .right-panel::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
        }

        .right-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #00ffff, #0080ff);
            border-radius: 3px;
        }

        .effects-container {
            position: relative;
            height: 180px;
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 25px;
            background: linear-gradient(135deg, rgba(0, 50, 100, 0.4), rgba(0, 100, 150, 0.4));
            border: 2px solid rgba(0, 255, 255, 0.2);
        }

        .neural-network-viz {
            position: absolute;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 255, 255, 0.3) 0%, transparent 30%),
                radial-gradient(circle at 80% 70%, rgba(255, 0, 255, 0.3) 0%, transparent 30%),
                radial-gradient(circle at 50% 50%, rgba(0, 255, 0, 0.2) 0%, transparent 40%);
            animation: neuralPulse 4s ease-in-out infinite;
        }

        @keyframes neuralPulse {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        .network-nodes {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .node {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #00ffff;
            border-radius: 50%;
            animation: nodeGlow 2s ease-in-out infinite;
        }

        @keyframes nodeGlow {
            0%, 100% { box-shadow: 0 0 5px #00ffff; }
            50% { box-shadow: 0 0 15px #00ffff, 0 0 25px #00ffff; }
        }

        .metrics-section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 16px;
            color: #00ffff;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
            background: linear-gradient(45deg, #00ffff, #0080ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(0, 150, 255, 0.1));
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(0, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            text-align: center;
        }

        .metric-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.3);
            border-color: #00ffff;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.2), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .metric-icon {
            font-size: 20px;
            margin-bottom: 8px;
        }

        .metric-title {
            font-size: 11px;
            color: #00aaff;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .metric-value {
            font-size: 18px;
            font-weight: bold;
            color: #00ffff;
            margin-bottom: 3px;
        }

        .metric-change {
            font-size: 9px;
            color: #00ff80;
        }

        .realtime-chart {
            height: 100px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 15px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0, 255, 255, 0.2);
        }

        .chart-title {
            position: absolute;
            top: 8px;
            left: 12px;
            font-size: 11px;
            color: #00ffff;
            font-weight: 600;
        }

        .chart-waves {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 70%;
        }

        .wave {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, rgba(0, 255, 255, 0.4), transparent);
            animation: waveFlow 2.5s ease-in-out infinite;
        }

        .wave:nth-child(2) {
            animation-delay: 0.5s;
            background: linear-gradient(180deg, rgba(0, 150, 255, 0.3), transparent);
        }

        .wave:nth-child(3) {
            animation-delay: 1s;
            background: linear-gradient(180deg, rgba(0, 100, 255, 0.2), transparent);
        }

        @keyframes waveFlow {
            0%, 100% { height: 30%; opacity: 0.8; }
            50% { height: 80%; opacity: 1; }
        }

        .ai-status-grid {
            display: grid;
            gap: 12px;
        }

        .status-card {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 12px;
            padding: 12px;
            border: 1px solid rgba(0, 255, 100, 0.3);
            position: relative;
        }

        .status-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #00ff00;
            margin-right: 8px;
            animation: statusBlink 1.5s infinite;
        }

        @keyframes statusBlink {
            0%, 70% { opacity: 1; }
            71%, 100% { opacity: 0.3; }
        }

        .status-title {
            font-size: 12px;
            color: #00ff80;
            font-weight: 600;
        }

        .status-detail {
            font-size: 10px;
            color: #aaa;
            line-height: 1.4;
        }

        .neural-activity {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 15px;
            border: 1px solid rgba(255, 0, 255, 0.3);
            margin-bottom: 20px;
        }

        .activity-bars {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 3px;
            height: 60px;
            align-items: end;
            margin-top: 10px;
        }

        .activity-bar {
            background: linear-gradient(180deg, #ff00ff, #8000ff);
            border-radius: 2px;
            animation: barPulse 1.5s ease-in-out infinite;
            min-height: 8px;
        }

        .activity-bar:nth-child(odd) {
            animation-delay: 0.2s;
        }

        .activity-bar:nth-child(even) {
            animation-delay: 0.4s;
        }

        @keyframes barPulse {
            0%, 100% { height: 20%; }
            50% { height: 90%; }
        }

        /* ========== 三维园区可视化 ========== */
        .building-3d-container {
            background: linear-gradient(135deg, rgba(0, 20, 40, 0.9), rgba(0, 40, 20, 0.9));
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(0, 255, 255, 0.4);
            margin-bottom: 20px;
            perspective: 1200px;
            height: 380px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
        }

        .campus-3d {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) rotateX(20deg) rotateY(0deg) rotateZ(0deg);
            transform-style: preserve-3d;
            animation: campusRotate 25s infinite linear;
        }

        @keyframes campusRotate {
            0% { transform: translate(-50%, -50%) rotateX(20deg) rotateY(0deg) rotateZ(0deg); }
            25% { transform: translate(-50%, -50%) rotateX(20deg) rotateY(90deg) rotateZ(0deg); }
            50% { transform: translate(-50%, -50%) rotateX(20deg) rotateY(180deg) rotateZ(0deg); }
            75% { transform: translate(-50%, -50%) rotateX(20deg) rotateY(270deg) rotateZ(0deg); }
            100% { transform: translate(-50%, -50%) rotateX(20deg) rotateY(360deg) rotateZ(0deg); }
        }

        .main-building {
            position: absolute;
            transform: translateZ(0) translateX(0px) translateY(0px);
            transform-style: preserve-3d;
        }

        .floor {
            position: absolute;
            width: 120px;
            height: 120px;
            transform-style: preserve-3d;
        }

        .floor:nth-child(1) { transform: translateY(150px); }
        .floor:nth-child(2) { transform: translateY(120px); }
        .floor:nth-child(3) { transform: translateY(90px); }
        .floor:nth-child(4) { transform: translateY(60px); }
        .floor:nth-child(5) { transform: translateY(30px); }
        .floor:nth-child(6) { transform: translateY(0px); }

        /* 园区地面 */
        .campus-ground {
            position: absolute;
            width: 250px;
            height: 250px;
            background: 
                radial-gradient(circle at center, rgba(0, 255, 128, 1) 0%, rgba(0, 200, 100, 0.9) 100%);
            border-radius: 15px;
            transform: translateY(150px) rotateX(90deg) translateZ(-125px);
            border: 5px solid #00ff80;
            box-shadow: 
                0 0 40px #00ff80, 
                inset 0 0 25px rgba(0, 255, 128, 0.7),
                0 0 70px rgba(0, 255, 128, 0.8);
            animation: groundPulse 3s ease-in-out infinite;
            z-index: 1;
            opacity: 1;
        }

        @keyframes groundPulse {
            0%, 100% { 
                transform: translateY(150px) rotateX(90deg) translateZ(-125px) scale(1);
                box-shadow: 
                    0 0 40px #00ff80, 
                    inset 0 0 25px rgba(0, 255, 128, 0.7),
                    0 0 70px rgba(0, 255, 128, 0.8);
            }
            50% { 
                transform: translateY(150px) rotateX(90deg) translateZ(-125px) scale(1.1);
                box-shadow: 
                    0 0 60px #00ff80, 
                    inset 0 0 35px rgba(0, 255, 128, 0.9),
                    0 0 100px rgba(0, 255, 128, 1);
            }
        }

        /* 园区道路 */
        .campus-road {
            position: absolute;
            width: 180px;
            height: 8px;
            background: linear-gradient(90deg, 
                rgba(200, 200, 200, 0.8) 0%,
                rgba(255, 255, 255, 0.9) 50%,
                rgba(200, 200, 200, 0.8) 100%);
            border-radius: 4px;
            transform: translateY(138px) rotateX(90deg) translateZ(-50px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.4);
            z-index: 2;
        }

        .campus-road.vertical {
            width: 8px;
            height: 180px;
            transform: translateY(138px) rotateX(90deg) translateZ(-50px) rotateZ(90deg);
        }

        /* 园区装饰点 */
        .campus-decoration {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(0, 255, 255, 0.9);
            border-radius: 50%;
            animation: decorationBlink 2s infinite;
            z-index: 3;
        }

        .decoration-1 { 
            transform: translateY(136px) rotateX(90deg) translateZ(-30px) translateX(-60px);
            animation-delay: 0s;
        }
        .decoration-2 { 
            transform: translateY(136px) rotateX(90deg) translateZ(-30px) translateX(60px);
            animation-delay: 0.5s;
        }
        .decoration-3 { 
            transform: translateY(136px) rotateX(90deg) translateZ(-70px) translateX(0px);
            animation-delay: 1s;
        }
        .decoration-4 { 
            transform: translateY(136px) rotateX(90deg) translateZ(-30px) translateX(0px);
            animation-delay: 1.5s;
        }

        @keyframes decorationBlink {
            0%, 100% { opacity: 1; box-shadow: 0 0 5px rgba(0, 255, 255, 0.6); }
            50% { opacity: 0.4; box-shadow: 0 0 15px rgba(0, 255, 255, 0.9); }
        }

        /* 立方体的六个面 */
        .floor-face {
            position: absolute;
            width: 120px;
            height: 35px;
        }

        .floor-top {
            background: linear-gradient(135deg, rgba(0, 200, 255, 0.9), rgba(0, 150, 255, 0.7));
            border: 1px solid rgba(0, 255, 255, 0.8);
            transform: rotateX(90deg) translateZ(17.5px);
        }

        .floor-bottom {
            background: linear-gradient(135deg, rgba(0, 80, 160, 0.8), rgba(0, 100, 180, 0.6));
            border: 1px solid rgba(0, 180, 255, 0.6);
            transform: rotateX(-90deg) translateZ(17.5px);
        }

        .floor-front {
            background: linear-gradient(180deg, rgba(0, 150, 255, 0.9), rgba(0, 100, 200, 0.7));
            border: 2px solid rgba(0, 255, 255, 0.8);
            transform: translateZ(60px);
        }

        .floor-back {
            background: linear-gradient(180deg, rgba(0, 120, 220, 0.8), rgba(0, 80, 160, 0.6));
            border: 1px solid rgba(0, 200, 255, 0.6);
            transform: translateZ(-60px) rotateY(180deg);
        }

        .floor-left {
            width: 120px;
            height: 35px;
            background: linear-gradient(90deg, rgba(0, 100, 200, 0.7), rgba(0, 130, 230, 0.5));
            border: 1px solid rgba(0, 220, 255, 0.5);
            transform: rotateY(-90deg) translateZ(60px);
        }

        .floor-right {
            width: 120px;
            height: 35px;
            background: linear-gradient(90deg, rgba(0, 130, 230, 0.7), rgba(0, 100, 200, 0.5));
            border: 1px solid rgba(0, 220, 255, 0.5);
            transform: rotateY(90deg) translateZ(60px);
        }

        .windows {
            position: absolute;
            top: 4px;
            left: 8px;
            right: 8px;
            bottom: 4px;
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 2px;
        }

        .windows-side {
            position: absolute;
            top: 4px;
            left: 8px;
            right: 8px;
            bottom: 4px;
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 2px;
        }

        .windows-back {
            position: absolute;
            top: 4px;
            left: 8px;
            right: 8px;
            bottom: 4px;
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 2px;
        }

        .window {
            background: rgba(255, 255, 0, 0.6);
            border-radius: 2px;
            animation: windowBlink 2s infinite ease-in-out;
        }

        .window.off {
            background: rgba(50, 50, 50, 0.8);
            animation: none;
        }

        @keyframes windowBlink {
            0%, 70% { opacity: 1; }
            71%, 100% { opacity: 0.3; }
        }

        .camera {
            position: absolute;
            width: 8px;
            height: 6px;
            background: linear-gradient(45deg, #ff0080, #8000ff);
            border-radius: 50% 50% 20% 20%;
            box-shadow: 0 0 6px rgba(255, 0, 128, 0.8);
            animation: cameraRotate 4s infinite ease-in-out;
            z-index: 10;
        }

        .camera::before {
            content: '';
            position: absolute;
            top: -1px;
            left: 2px;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, #00ffff, #0080ff);
            border-radius: 50%;
            animation: cameraLens 2s infinite;
        }

        @keyframes cameraRotate {
            0%, 100% { transform: rotateZ(-5deg); }
            50% { transform: rotateZ(5deg); }
        }

        @keyframes cameraLens {
            0%, 100% { box-shadow: 0 0 3px #00ffff; }
            50% { box-shadow: 0 0 8px #00ffff, 0 0 12px #0080ff; }
        }

        .camera-1 { 
            top: 3px; 
            right: 10px; 
            transform: translateZ(1px);
        }
        .camera-2 { 
            top: 3px; 
            left: 10px; 
            animation-delay: 0.5s;
            transform: translateZ(1px);
        }
        .camera-3 { 
            bottom: 3px; 
            left: 50%; 
            transform: translateX(-50%) translateZ(1px);
            animation-delay: 1s; 
        }
        .camera-4 { 
            bottom: 3px; 
            right: 10px; 
            transform: translateZ(1px);
            animation-delay: 1.5s; 
        }

        .building-info {
            position: absolute;
            bottom: 10px;
            left: 10px;
            font-size: 10px;
            color: #00ffff;
            background: rgba(0, 0, 0, 0.8);
            padding: 5px 8px;
            border-radius: 5px;
            border: 1px solid rgba(0, 255, 255, 0.3);
        }

        .floor-label {
            position: absolute;
            right: -25px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 8px;
            color: #00ff80;
            background: rgba(0, 0, 0, 0.8);
            padding: 2px 4px;
            border-radius: 3px;
            border: 1px solid rgba(0, 255, 128, 0.5);
        }

        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ffff, transparent);
            animation: scanBuilding 6s infinite linear;
        }

        @keyframes scanBuilding {
            0% { top: 0%; opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }

        /* ========== 神经节点状态样式 ========== */
        .neural-nodes-section {
            margin-bottom: 20px;
        }

        .node-status-card {
            background: rgba(15, 30, 45, 0.9);
            border-radius: 15px;
            padding: 18px;
            margin-bottom: 15px;
            border: 1px solid rgba(0, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .node-status-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.2);
        }

        .node-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .node-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 12px;
            animation: nodePulse 2s infinite;
        }

        .node-indicator.active {
            background: #00ffff;
            box-shadow: 0 0 10px #00ffff;
        }

        .node-indicator.warning {
            background: #ffaa00;
            box-shadow: 0 0 10px #ffaa00;
        }

        @keyframes nodePulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        .node-name {
            flex: 1;
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
        }

        .node-status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .node-status-badge.active {
            background: rgba(0, 255, 255, 0.2);
            color: #00ffff;
            border: 1px solid #00ffff;
        }

        .node-details {
            margin-top: 15px;
        }

        .detail-row {
            display: grid;
            grid-template-columns: auto auto auto auto;
            gap: 10px;
            margin-bottom: 8px;
            font-size: 13px;
            color: #cccccc;
        }

        .detail-value {
            font-weight: 600;
            text-align: right;
        }

        .detail-value.strong {
            color: #00ff88;
        }

        .detail-value.warning {
            color: #ffaa00;
        }

        .progress-bar-node {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-top: 12px;
            overflow: hidden;
        }

        .progress-fill-node {
            height: 100%;
            background: linear-gradient(90deg, #00ffff, #0080ff);
            border-radius: 3px;
            transition: width 0.3s ease;
            position: relative;
        }

        .progress-fill-node.warning {
            background: linear-gradient(90deg, #ffaa00, #ff8800);
        }

        .progress-fill-node::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: progressShimmer 2s infinite;
        }

        @keyframes progressShimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* ========== 响应式设计 ========== */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
                height: auto;
                gap: 20px;
            }

            .left-panel, .right-panel {
                height: auto;
            }

            .effects-container {
                height: 150px;
            }
        }

        /* ========== 加载动画 ========== */
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #00f5ff;
            animation: spin 1s ease-in-out infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #00f5ff, #ff00ff);
            width: 0%;
            transition: width 0.3s;
            border-radius: 4px;
            position: relative;
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- 顶部标题栏 -->
    <div class="top-header">
        <div class="header-content">
            <div class="system-logo">🏢</div>
            <div class="system-title">智慧园区监控系统</div>
            <div class="system-subtitle">园区 • 监控 • 智能 • 管理</div>
            <div class="system-status">
                <div class="status-indicator running"></div>
                <span>园区监控中 - 全域感知模式</span>
            </div>
        </div>
    </div>

    <div class="main-container">
        <!-- 左侧视频上传区域 -->
        <div class="left-panel">
            <h2 class="panel-title">🎥 视频数据源</h2>
            
            <div class="upload-zone" id="uploadZone">
                <div class="upload-icon">📁</div>
                <p>拖拽视频文件到此处</p>
                <p style="font-size: 12px; color: #888; margin-top: 5px;">
                    支持 MP4, AVI, MOV 格式
                </p>
                <input type="file" id="videoInput" accept="video/*" style="display: none;">
            </div>

            <video class="video-preview" id="videoPreview" controls muted></video>
            
            <div class="video-info" id="videoInfo">
                <h4 style="color: #00f5ff; margin-bottom: 10px;">📊 视频信息</h4>
                <div id="videoDetails"></div>
            </div>

            <button class="select-btn" id="selectVideoBtn">选择此视频进行分析</button>
        </div>

        <!-- 中间分析区域 -->
        <div class="center-panel">
            <div class="search-container">
                <div class="search-box">
                    <input type="text" class="search-input" id="searchInput" 
                           placeholder="请评估过去一周能源使用效率？" value="请评估过去一周能源使用效率">
                    <button class="analyze-btn" id="analyzeBtn">🚀 开始分析</button>
                </div>
            </div>

            <div class="analysis-display" id="analysisDisplay">
                <div class="analysis-status" id="analysisStatus">
                    <div class="status-text">🤖 AI正在进行多模态分析...</div>
                    <div class="loading-spinner"></div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p id="statusMessage">正在初始化深度学习模型...</p>
                </div>

                <div class="frame-carousel" id="frameCarousel">
                    <div class="analysis-overlay"></div>
                </div>

                <div class="extraction-info" id="extractionInfo">
                    <h4 style="color: #00f5ff; margin-bottom: 10px;">🔍 实时信息提取</h4>
                    <div id="extractionDetails">准备开始多维度分析...</div>
                </div>

                <div class="result-display" id="resultDisplay">
                    <h3 style="color: #ff00ff; margin-bottom: 20px;">📈 能源效率评估报告</h3>
                    <div id="analysisResults"></div>
                </div>
            </div>
        </div>

        <!-- 右侧效果和指标区域 -->
        <div class="right-panel">
            <h2 class="panel-title">🧠 AI神经网络监控</h2>
            
            <!-- 三维园区监控 -->
            <div class="building-3d-container">
                <div class="section-title" style="margin-bottom: 15px; font-size: 14px;">🏢 智慧园区3D监控</div>
                <div class="campus-3d" id="campus3D">
                    <!-- 园区地面 -->
                    <div class="campus-ground"></div>
                    
                    <!-- 园区道路 -->
                    <div class="campus-road"></div>
                    <div class="campus-road vertical"></div>
                    
                    <!-- 园区装饰点 -->
                    <div class="campus-decoration decoration-1"></div>
                    <div class="campus-decoration decoration-2"></div>
                    <div class="campus-decoration decoration-3"></div>
                    <div class="campus-decoration decoration-4"></div>
                </div>
                <div class="scan-line"></div>
                <div class="building-info">
                    <div>📹 摄像头: 12个在线</div>
                    <div>🔍 监控覆盖: 100%</div>
                    <div>🌿 园区环境: 优良</div>
                    <div>🏢 建筑状态: 正常</div>
                </div>
            </div>

            <!-- 神经节点状态 -->
            <div class="neural-nodes-section">
                <div class="section-title">⚡ 神经节点状态</div>
                
                <div class="node-status-card">
                    <div class="node-header">
                        <div class="node-indicator active"></div>
                        <div class="node-name">1F-大厅区域</div>
                        <div class="node-status-badge active">活跃</div>
                    </div>
                    <div class="node-details">
                        <div class="detail-row">
                            <span>节点数量:</span>
                            <span class="detail-value">4</span>
                            <span>信号强度:</span>
                            <span class="detail-value strong">97%</span>
                        </div>
                        <div class="detail-row">
                            <span>最后同步:</span>
                            <span class="detail-value">0.8s前</span>
                            <span>负载:</span>
                            <span class="detail-value">28%</span>
                        </div>
                        <div class="progress-bar-node">
                            <div class="progress-fill-node" style="width: 97%;"></div>
                        </div>
                    </div>
                </div>

                <div class="node-status-card">
                    <div class="node-header">
                        <div class="node-indicator active"></div>
                        <div class="node-name">2F-办公区域</div>
                        <div class="node-status-badge active">活跃</div>
                    </div>
                    <div class="node-details">
                        <div class="detail-row">
                            <span>节点数量:</span>
                            <span class="detail-value">2</span>
                            <span>信号强度:</span>
                            <span class="detail-value strong">95%</span>
                        </div>
                        <div class="detail-row">
                            <span>最后同步:</span>
                            <span class="detail-value">1.2s前</span>
                            <span>负载:</span>
                            <span class="detail-value">42%</span>
                        </div>
                        <div class="progress-bar-node">
                            <div class="progress-fill-node" style="width: 95%;"></div>
                        </div>
                    </div>
                </div>

                <div class="node-status-card">
                    <div class="node-header">
                        <div class="node-indicator active"></div>
                        <div class="node-name">停车场A区</div>
                        <div class="node-status-badge active">活跃</div>
                    </div>
                    <div class="node-details">
                        <div class="detail-row">
                            <span>节点数量:</span>
                            <span class="detail-value">3</span>
                            <span>信号强度:</span>
                            <span class="detail-value strong">99%</span>
                        </div>
                        <div class="detail-row">
                            <span>最后同步:</span>
                            <span class="detail-value">0.5s前</span>
                            <span>负载:</span>
                            <span class="detail-value">18%</span>
                        </div>
                        <div class="progress-bar-node">
                            <div class="progress-fill-node" style="width: 99%;"></div>
                        </div>
                    </div>
                </div>

                <div class="node-status-card">
                    <div class="node-header">
                        <div class="node-indicator warning"></div>
                        <div class="node-name">停车场B区</div>
                        <div class="node-status-badge active">活跃</div>
                    </div>
                    <div class="node-details">
                        <div class="detail-row">
                            <span>节点数量:</span>
                            <span class="detail-value">6</span>
                            <span>信号强度:</span>
                            <span class="detail-value warning">89%</span>
                        </div>
                        <div class="detail-row">
                            <span>最后同步:</span>
                            <span class="detail-value">2.1s前</span>
                            <span>负载:</span>
                            <span class="detail-value">56%</span>
                        </div>
                        <div class="progress-bar-node">
                            <div class="progress-fill-node warning" style="width: 89%;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class MultimodalEnergyAnalysis {
            constructor() {
                this.currentVideo = null;
                this.isAnalyzing = false;
                this.frameIndex = 0;
                this.analysisFrames = [];
                
                this.initElements();
                this.bindEvents();
                this.startMetricsAnimation();
            }

            initElements() {
                this.uploadZone = document.getElementById('uploadZone');
                this.videoInput = document.getElementById('videoInput');
                this.videoPreview = document.getElementById('videoPreview');
                this.videoInfo = document.getElementById('videoInfo');
                this.selectBtn = document.getElementById('selectVideoBtn');
                this.analyzeBtn = document.getElementById('analyzeBtn');
                this.analysisDisplay = document.getElementById('analysisDisplay');
                this.frameCarousel = document.getElementById('frameCarousel');
                this.progressFill = document.getElementById('progressFill');
                this.statusMessage = document.getElementById('statusMessage');
                this.extractionInfo = document.getElementById('extractionDetails');
                this.resultDisplay = document.getElementById('resultDisplay');
                
                // 初始化右侧面板
                this.initRightPanel();
            }

            bindEvents() {
                this.uploadZone.addEventListener('click', () => this.videoInput.click());
                this.uploadZone.addEventListener('dragover', this.handleDragOver.bind(this));
                this.uploadZone.addEventListener('drop', this.handleDrop.bind(this));
                this.videoInput.addEventListener('change', this.handleVideoSelect.bind(this));
                this.selectBtn.addEventListener('click', this.selectVideo.bind(this));
                this.analyzeBtn.addEventListener('click', this.startAnalysis.bind(this));
            }

            handleDragOver(e) {
                e.preventDefault();
                this.uploadZone.classList.add('dragover');
            }

            handleDrop(e) {
                e.preventDefault();
                this.uploadZone.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0 && files[0].type.startsWith('video/')) {
                    this.loadVideo(files[0]);
                }
            }

            handleVideoSelect(e) {
                const file = e.target.files[0];
                if (file) {
                    this.loadVideo(file);
                }
            }

            loadVideo(file) {
                const url = URL.createObjectURL(file);
                this.videoPreview.src = url;
                this.videoPreview.style.display = 'block';
                
                this.videoPreview.addEventListener('loadedmetadata', () => {
                    const duration = this.formatTime(this.videoPreview.duration);
                    const size = this.formatFileSize(file.size);
                    
                    document.getElementById('videoDetails').innerHTML = `
                        <p><strong>文件名:</strong> ${file.name}</p>
                        <p><strong>分辨率:</strong> ${this.videoPreview.videoWidth}x${this.videoPreview.videoHeight}</p>
                    `;
                    
                    this.videoInfo.style.display = 'block';
                    this.selectBtn.style.display = 'block';
                });
            }

            selectVideo() {
                this.currentVideo = this.videoPreview.src;
                this.selectBtn.textContent = '✅ 视频已选择';
                this.selectBtn.style.background = 'linear-gradient(45deg, #00ff00, #00aa00)';
                
                // 生成分析帧
                this.generateAnalysisFrames();
            }

            generateAnalysisFrames() {
                const imageUrls = [
                    'st/1.png',
                    'st/2.png', 
                    'st/3.png',
                    'st/4.png',
                    'st/5.png'
                ];
                
                this.analysisFrames = [
                    { time: '09:00', energy: 85, frame: imageUrls[0] },
                    { time: '15:00', energy: 72, frame: imageUrls[1] },
                    { time: '21:00', energy: 91, frame: imageUrls[2] },
                    { time: '12:00', energy: 68, frame: imageUrls[3] },
                    { time: '18:00', energy: 78, frame: imageUrls[4] }
                ];
            }

            createEnergyFrame(efficiency, timeLabel) {
                const canvas = document.createElement('canvas');
                canvas.width = 800;
                canvas.height = 600;
                const ctx = canvas.getContext('2d');
                
                // 背景渐变
                const gradient = ctx.createLinearGradient(0, 0, 800, 600);
                gradient.addColorStop(0, '#001122');
                gradient.addColorStop(1, '#000515');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, 800, 600);
                
                // 绘制能源效率可视化
                ctx.strokeStyle = '#00ffff';
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                // 绘制效率曲线
                for (let i = 0; i < 24; i++) {
                    const x = 50 + (i * 30);
                    const baseY = 400;
                    const variation = Math.sin(i * 0.5) * 50 + (efficiency / 100) * 100;
                    const y = baseY - variation;
                    
                    if (i === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
                
                // 标题
                ctx.fillStyle = '#00ffff';
                ctx.font = 'bold 24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`能源效率分析 - ${timeLabel}`, 400, 50);
                
                // 效率值
                ctx.fillStyle = efficiency > 80 ? '#00ff00' : efficiency > 60 ? '#ffff00' : '#ff6600';
                ctx.font = 'bold 48px Arial';
                ctx.fillText(`${efficiency}%`, 400, 150);
                
                // 详细信息
                ctx.fillStyle = '#ffffff';
                ctx.font = '16px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`时间段: ${timeLabel}`, 50, 500);
                ctx.fillText(`平均功耗: ${(efficiency * 1.2).toFixed(1)} kW`, 50, 530);
                ctx.fillText(`碳排放: ${(100 - efficiency) * 0.5} kg CO₂`, 50, 560);
                
                return canvas.toDataURL();
            }

            async startAnalysis() {
                if (!this.currentVideo) {
                    alert('请先选择视频文件！');
                    return;
                }

                this.isAnalyzing = true;
                this.analysisDisplay.style.display = 'block';
                this.resultDisplay.style.display = 'none';
                
                // 显示loading状态
                const analysisStatus = document.getElementById('analysisStatus');
                analysisStatus.style.display = 'block';
                analysisStatus.classList.remove('hidden');
                
                // 分析流程
                await this.runAnalysisSteps();
            }

            async runAnalysisSteps() {
                const steps = [
                    { message: '正在加载视频数据...', progress: 5 },
                    { message: '初始化多模态AI模型...', progress: 10 },
                    { message: '提取关键帧进行分析...', progress: 15 },
                    { message: '执行深度学习预处理...', progress: 25 },
                    { message: '能源使用模式识别...', progress: 35 },
                    { message: '时间序列数据分析...', progress: 45 },
                    { message: '空间分布模式分析...', progress: 55 },
                    { message: '异常检测和模式识别...', progress: 65 },
                    { message: '效率指标计算...', progress: 75 },
                    { message: '智能优化建议生成...', progress: 85 },
                    { message: '综合评估报告生成...', progress: 95 },
                    { message: '✅ 多模态分析完成！', progress: 100 }
                ];

                for (let i = 0; i < steps.length; i++) {
                    this.statusMessage.textContent = steps[i].message;
                    this.progressFill.style.width = steps[i].progress + '%';
                    
                    // 在步骤3-7显示帧分析
                    if (i >= 3 && i < 8) {
                        this.showFrameAnalysis(i - 3);
                    }
                    
                    await this.sleep(1200);
                }

                // 分析完成，停止loading状态
                this.isAnalyzing = false;
                
                // 平滑隐藏loading指示器
                const analysisStatus = document.getElementById('analysisStatus');
                analysisStatus.classList.add('hidden');
                
                // 延迟完全隐藏，让过渡动画完成
                setTimeout(() => {
                    analysisStatus.style.display = 'none';
                }, 500);
                
                this.showResults();
            }

            showFrameAnalysis(frameIndex) {
                if (frameIndex >= this.analysisFrames.length) return;
                
                const frame = this.analysisFrames[frameIndex];
                
                // 清空轮播容器
                this.frameCarousel.innerHTML = '<div class="analysis-overlay"></div>';
                
                // 创建图片元素
                const img = document.createElement('img');
                img.src = frame.frame;
                img.className = 'frame-image active analyzing';
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.objectFit = 'cover';
                
                // 图片加载失败时的处理
                img.onerror = () => {
                    console.log('图片加载失败，使用生成的占位图');
                    img.src = this.createEnergyFrame(frame.energy, `分析帧 ${frameIndex + 1}`);
                };
                
                this.frameCarousel.appendChild(img);
                
                // 更新提取信息
                const analysisDetails = this.getDetailedAnalysisInfo(frameIndex, frame);
                this.extractionInfo.innerHTML = `
                    <h4 style="color: #00f5ff; margin-bottom: 10px;">🔍 ${analysisDetails.title}</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 13px;">
                        <div>⚡ 能源效率: <span style="color: #00ff00">${frame.energy}%</span></div>
                        <div>🌡️ 环境温度: <span style="color: #ffff00">${analysisDetails.temp}°C</span></div>
                        <div>💡 设备状态: <span style="color: #00ffff">${analysisDetails.devices}</span></div>
                        <div>📊 负载系数: <span style="color: #ff00ff">${analysisDetails.load}</span></div>
                        <div>🔋 功耗预估: <span style="color: #ffa500">${analysisDetails.power}</span></div>
                        <div>🎯 模式识别: <span style="color: #00ff80">${analysisDetails.mode}</span></div>
                    </div>
                    <div style="margin-top: 10px; padding: 8px; background: rgba(0,255,255,0.1); border-radius: 5px;">
                        <div style="font-size: 12px; color: #00ffff;">🔮 AI分析维度: ${analysisDetails.dimension}</div>
                        <div style="font-size: 12px; color: #ff00ff;">📈 置信度: ${analysisDetails.confidence}% | 处理: ${analysisDetails.processing}</div>
                    </div>
                `;
            }

            getDetailedAnalysisInfo(frameIndex, frame) {
                const analysisTemplates = [
                    {
                        title: '周一上午能源模式分析 (09:00)',
                        temp: (18 + Math.random() * 4).toFixed(1),
                        devices: '空调+照明+设备',
                        load: '0.85',
                        power: '12.4 kWh',
                        mode: '办公高效模式',
                        dimension: '时间序列 + 空间分布',
                        confidence: (88 + Math.random() * 8).toFixed(1),
                        processing: '深度卷积分析'
                    },
                    {
                        title: '周二下午负载分析 (15:00)',
                        temp: (20 + Math.random() * 3).toFixed(1),
                        devices: '空调+部分照明',
                        load: '0.72',
                        power: '9.8 kWh',
                        mode: '标准工作模式',
                        dimension: '热力图 + 行为识别',
                        confidence: (85 + Math.random() * 10).toFixed(1),
                        processing: '多模态融合'
                    },
                    {
                        title: '周三晚间峰值分析 (21:00)',
                        temp: (16 + Math.random() * 3).toFixed(1),
                        devices: '全部设备运行',
                        load: '0.91',
                        power: '15.2 kWh',
                        mode: '夜间高效模式',
                        dimension: '异常检测 + 模式识别',
                        confidence: (92 + Math.random() * 6).toFixed(1),
                        processing: 'Transformer模型'
                    },
                    {
                        title: '周四中午低效分析 (12:00)',
                        temp: (22 + Math.random() * 4).toFixed(1),
                        devices: '空调过载+照明',
                        load: '0.68',
                        power: '8.5 kWh',
                        mode: '优化待改进',
                        dimension: '能耗异常 + 环境因子',
                        confidence: (79 + Math.random() * 12).toFixed(1),
                        processing: '决策树分析'
                    },
                    {
                        title: '周五傍晚过渡分析 (18:00)',
                        temp: (19 + Math.random() * 3).toFixed(1),
                        devices: '渐进式启动',
                        load: '0.78',
                        power: '11.1 kWh',
                        mode: '过渡平衡模式',
                        dimension: '时序预测 + 趋势分析',
                        confidence: (86 + Math.random() * 9).toFixed(1),
                        processing: 'LSTM时序网络'
                    }
                ];
                
                return analysisTemplates[frameIndex] || analysisTemplates[0];
            }

            showResults() {
                this.resultDisplay.style.display = 'block';
                this.resultDisplay.innerHTML = `
                    <h3 style="color: #ff00ff; margin-bottom: 20px;">📈 一周能源效率多模态分析报告</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                        <div style="background: rgba(0,100,255,0.2); padding: 15px; border-radius: 12px; border: 1px solid rgba(0,255,255,0.3);">
                            <h4 style="color: #00ffff; font-size: 14px;">📊 综合评分</h4>
                            <div style="font-size: 28px; color: #00ff00; font-weight: bold;">78.6%</div>
                            <p style="font-size: 11px; color: #ccc;">较上周提升 +3.2%</p>
                        </div>
                        
                        <div style="background: rgba(255,0,100,0.2); padding: 15px; border-radius: 12px; border: 1px solid rgba(255,0,255,0.3);">
                            <h4 style="color: #ff00ff; font-size: 14px;">⚡ 节能潜力</h4>
                            <div style="font-size: 28px; color: #ffff00; font-weight: bold;">21.4%</div>
                            <p style="font-size: 11px; color: #ccc;">预估节省 2.1 kWh/天</p>
                        </div>
                        
                        <div style="background: rgba(0,255,100,0.2); padding: 15px; border-radius: 12px; border: 1px solid rgba(0,255,0,0.3);">
                            <h4 style="color: #00ff80; font-size: 14px;">🔋 平均功耗</h4>
                            <div style="font-size: 28px; color: #00ff00; font-weight: bold;">11.4kW</div>
                            <p style="font-size: 11px; color: #ccc;">峰值: 15.2kW</p>
                        </div>
                        
                        <div style="background: rgba(255,100,0,0.2); padding: 15px; border-radius: 12px; border: 1px solid rgba(255,165,0,0.3);">
                            <h4 style="color: #ffa500; font-size: 14px;">🌡️ 环境指数</h4>
                            <div style="font-size: 28px; color: #ffff00; font-weight: bold;">19.2°C</div>
                            <p style="font-size: 11px; color: #ccc;">适宜温度范围</p>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div style="background: rgba(0,0,0,0.7); padding: 20px; border-radius: 15px; border: 1px solid rgba(100,255,255,0.3);">
                            <h4 style="color: #00ffff; margin-bottom: 15px;">📊 整体使用分析</h4>
                            <div style="margin-bottom: 10px;">
                                <span style="color: #88ff88;">• 高效时段：</span> 周三21:00 (91%)
                            </div>
                            <div style="margin-bottom: 10px;">
                                <span style="color: #ffff88;">• 标准时段：</span> 周一09:00, 周五18:00
                            </div>
                            <div style="margin-bottom: 10px;">
                                <span style="color: #ff8888;">• 待优化：</span> 周四12:00 (68%)
                            </div>
                            <div>
                                <span style="color: #8888ff;">• 平均负载：</span> 0.79 (良好)
                            </div>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.7); padding: 20px; border-radius: 15px; border: 1px solid rgba(255,0,255,0.3);">
                            <h4 style="color: #ff00ff; margin-bottom: 15px;">⚡ 能耗模式识别</h4>
                            <div style="margin-bottom: 10px;">
                                <span style="color: #00ff80;">• 办公模式：</span> 42% (上午时段)
                            </div>
                            <div style="margin-bottom: 10px;">
                                <span style="color: #80ff80;">• 高效模式：</span> 28% (晚间优化)
                            </div>
                            <div style="margin-bottom: 10px;">
                                <span style="color: #ffff80;">• 过渡模式：</span> 18% (傍晚时段)
                            </div>
                            <div>
                                <span style="color: #ff8080;">• 低效模式：</span> 12% (需优化)
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(0,0,0,0.8); padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px solid rgba(255,215,0,0.4);">
                        <h4 style="color: #ffd700; margin-bottom: 15px;">🔍 深度学习分析发现</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 13px;">
                            <div>
                                <div style="color: #00ffff; margin-bottom: 5px;">🧠 神经网络识别:</div>
                                <ul style="list-style: none; padding-left: 10px; color: #ccc;">
                                    <li>• 异常模式检测: 3处长时照明</li>
                                    <li>• 行为模式分析: 工作型67%</li>
                                    <li>• 时序预测准确率: 94.2%</li>
                                </ul>
                            </div>
                            <div>
                                <div style="color: #ff00ff; margin-bottom: 5px;">📈 多维度融合:</div>
                                <ul style="list-style: none; padding-left: 10px; color: #ccc;">
                                    <li>• 空间分布热力图: 东南角密度最高</li>
                                    <li>• 时间序列趋势: 总体上升3.2%</li>
                                    <li>• 环境关联度: 温度影响占23%</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div style="background: rgba(0,50,100,0.3); padding: 20px; border-radius: 15px; border-left: 4px solid #0080ff;">
                            <h4 style="color: #0080ff; margin-bottom: 15px;">🎯 优化建议</h4>
                            <div style="font-size: 13px; line-height: 1.6;">
                                <div style="margin-bottom: 10px;">
                                    <span style="color: #00ffff;">1. 智能调节:</span> 中午12:00-14:00启用AI控制
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <span style="color: #00ffff;">2. 分时策略:</span> 峰谷电价时段优化
                                </div>
                                <div>
                                    <span style="color: #00ffff;">3. 设备升级:</span> 建议更换老旧空调系统
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(0,100,50,0.3); padding: 20px; border-radius: 15px; border-left: 4px solid #00aa00;">
                            <h4 style="color: #00ff00; margin-bottom: 15px;">💰 经济效益预测</h4>
                            <div style="font-size: 13px; line-height: 1.6;">
                                <div style="margin-bottom: 10px;">
                                    <span style="color: #00ffff;">节省电费:</span> <span style="color: #00ff00;">¥1,250/月</span>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <span style="color: #00ffff;">投资回收:</span> <span style="color: #ffff00;">8个月</span>
                                </div>
                                <div>
                                    <span style="color: #00ffff;">年度收益:</span> <span style="color: #00ff00;">¥15,000</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, rgba(100,0,255,0.2), rgba(255,0,100,0.2)); padding: 20px; border-radius: 15px; border: 2px solid rgba(255,100,255,0.4); text-align: center;">
                        <h4 style="color: #ff00ff; margin-bottom: 15px;">🚀 AI驱动的未来预期</h4>
                        <p style="font-size: 15px; line-height: 1.8; color: #ffffff;">
                            通过持续的多模态学习和优化，预计在 <span style="color: #00ffff; font-weight: bold;">3个月内</span> 
                            可将整体能源效率提升至 <span style="color: #00ff00; font-weight: bold;">85.2%</span>，
                            实现 <span style="color: #ffff00; font-weight: bold;">智能化、绿色化</span> 的能源管理目标。
                        </p>
                    </div>
                `;
            }

            initRightPanel() {
                // 创建3D园区
                this.create3DCampus();
                
                // 初始化神经节点状态动画
                this.startNodeStatusAnimation();
            }

            startNodeStatusAnimation() {
                // 动态更新节点状态
                setInterval(() => {
                    const progressBars = document.querySelectorAll('.progress-fill-node');
                    progressBars.forEach(bar => {
                        if (!bar.classList.contains('warning')) {
                            const currentWidth = parseInt(bar.style.width);
                            const variation = Math.random() * 4 - 2; // ±2%
                            const newWidth = Math.max(85, Math.min(99, currentWidth + variation));
                            bar.style.width = newWidth + '%';
                        }
                    });
                }, 3000);
            }

            create3DCampus() {
                const campus3D = document.getElementById('campus3D');
                console.log('Creating campus 3D scene...'); // 调试信息
                
                // 创建主建筑物（园区地面和停车场已在HTML中定义）
                const mainBuilding = document.createElement('div');
                mainBuilding.className = 'main-building';
                
                // 创建6层建筑
                for (let floor = 1; floor <= 6; floor++) {
                    const floorDiv = document.createElement('div');
                    floorDiv.className = 'floor';
                    
                    // 创建立方体的六个面
                    const faces = ['top', 'bottom', 'front', 'back', 'left', 'right'];
                    faces.forEach(face => {
                        const faceDiv = document.createElement('div');
                        faceDiv.className = `floor-face floor-${face}`;
                        floorDiv.appendChild(faceDiv);
                    });
                    
                    // 为前面、后面、左侧、右侧四个面添加窗户
                    const facesWithWindows = ['front', 'back', 'left', 'right'];
                    facesWithWindows.forEach(faceName => {
                        const face = floorDiv.querySelector(`.floor-${faceName}`);
                        const windows = document.createElement('div');
                        
                        // 根据面的不同设置不同的窗户布局
                        if (faceName === 'front' || faceName === 'back') {
                            windows.className = 'windows';
                            // 前面和后面每层20个窗户
                            for (let i = 0; i < 20; i++) {
                                const window = document.createElement('div');
                                window.className = 'window';
                                if (Math.random() < 0.2) {
                                    window.classList.add('off');
                                } else {
                                    window.style.animationDelay = Math.random() * 2 + 's';
                                }
                                windows.appendChild(window);
                            }
                        } else {
                            windows.className = 'windows-side';
                            // 左侧和右侧每层16个窗户
                            for (let i = 0; i < 16; i++) {
                                const window = document.createElement('div');
                                window.className = 'window';
                                if (Math.random() < 0.2) {
                                    window.classList.add('off');
                                } else {
                                    window.style.animationDelay = Math.random() * 2 + 's';
                                }
                                windows.appendChild(window);
                            }
                        }
                        
                        face.appendChild(windows);
                    });
                    
                    // 在每个面的特定楼层添加摄像头
                    const cameraFloors = [2, 4, 6];
                    if (cameraFloors.includes(floor)) {
                        facesWithWindows.forEach((faceName, faceIndex) => {
                            const face = floorDiv.querySelector(`.floor-${faceName}`);
                            const camera = document.createElement('div');
                            camera.className = `camera camera-${faceIndex + 1}`;
                            camera.style.animationDelay = `${faceIndex * 0.5}s`;
                            face.appendChild(camera);
                        });
                    }
                    
                    mainBuilding.appendChild(floorDiv);
                }
                
                campus3D.appendChild(mainBuilding);
                
                console.log('Campus 3D scene created successfully!'); // 调试信息
            }


            startMetricsAnimation() {
                // 右侧面板现在使用神经节点状态，不需要额外的指标动画
            }

            formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs.toString().padStart(2, '0')}`;
            }

            formatFileSize(bytes) {
                const units = ['B', 'KB', 'MB', 'GB'];
                let size = bytes;
                let unitIndex = 0;
                
                while (size >= 1024 && unitIndex < units.length - 1) {
                    size /= 1024;
                    unitIndex++;
                }
                
                return `${size.toFixed(1)} ${units[unitIndex]}`;
            }

            sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', () => {
            window.energyAnalysis = new MultimodalEnergyAnalysis();
        });
    </script>
</body>
</html>